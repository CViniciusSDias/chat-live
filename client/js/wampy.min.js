!function n(r,c,a){function _(t,e){if(!c[t]){if(!r[t]){var s="function"==typeof require&&require;if(!e&&s)return s(t,!0);if(h)return h(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=c[t]={exports:{}};r[t][0].call(o.exports,function(e){return _(r[t][1][e]||e)},o,o.exports,n,r,c,a)}return c[t].exports}for(var h="function"==typeof require&&require,e=0;e<a.length;e++)_(a[e]);return _}({1:[function(e,t,s){var i,o,n=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===r||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:r}catch(e){i=r}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var _,h=[],l=!1,u=-1;function p(){l&&_&&(l=!1,_.length?h=_.concat(h):u=-1,h.length&&d())}function d(){if(!l){var e=a(p);l=!0;for(var t=h.length;t;){for(_=h,h=[];++u<t;)_&&_[u].run();u=-1,t=h.length}_=null,l=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function S(e,t){this.fun=e,this.array=t}function E(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];h.push(new S(e,t)),1!==h.length||l||a(d)},S.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=E,n.addListener=E,n.once=E,n.off=E,n.removeListener=E,n.removeAllListeners=E,n.emit=E,n.prependListener=E,n.prependOnceListener=E,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(e,t,s){"use strict";var i=e("./wampy");window.Wampy=i.Wampy},{"./wampy":6}],3:[function(e,t,s){(function(e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};s.WAMP_MSG_SPEC={HELLO:1,WELCOME:2,ABORT:3,CHALLENGE:4,AUTHENTICATE:5,GOODBYE:6,ERROR:8,PUBLISH:16,PUBLISHED:17,SUBSCRIBE:32,SUBSCRIBED:33,UNSUBSCRIBE:34,UNSUBSCRIBED:35,EVENT:36,CALL:48,CANCEL:49,RESULT:50,REGISTER:64,REGISTERED:65,UNREGISTER:66,UNREGISTERED:67,INVOCATION:68,INTERRUPT:69,YIELD:70},s.WAMP_ERROR_MSG={SUCCESS:{code:0,description:"Success!"},URI_ERROR:{code:1,description:"Topic URI doesn't meet requirements!"},NO_BROKER:{code:2,description:"Server doesn't provide broker role!"},NO_CALLBACK_SPEC:{code:3,description:"No required callback function specified!"},INVALID_PARAM:{code:4,description:"Invalid parameter(s) specified!"},NON_EXIST_UNSUBSCRIBE:{code:7,description:"Trying to unsubscribe from non existent subscription!"},NO_DEALER:{code:12,description:"Server doesn't provide dealer role!"},RPC_ALREADY_REGISTERED:{code:15,description:"RPC already registered!"},NON_EXIST_RPC_UNREG:{code:17,description:"Received rpc unregistration for non existent rpc!"},NON_EXIST_RPC_INVOCATION:{code:19,description:"Received invocation for non existent rpc!"},NON_EXIST_RPC_REQ_ID:{code:20,description:"No RPC calls in action with specified request ID!"},NO_REALM:{code:21,description:"No realm specified!"},NO_WS_OR_URL:{code:22,description:"No websocket provided or URL specified is incorrect!"},NO_CRA_CB_OR_ID:{code:23,description:"No onChallenge callback or authid was provided for authentication!"},CRA_EXCEPTION:{code:24,description:"Exception raised during CRA challenge processing"}},s.ALLOWED_BINARY_TYPES=["blob","arraybuffer"],s.isNode="object"===(void 0===e?"undefined":t(e))&&"[object process]"===Object.prototype.toString.call(e)}).call(this,e("_process"))},{_process:1}],4:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=function(){function i(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,s){return t&&i(e.prototype,t),s&&i(e,s),e}}();s.JsonSerializer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.protocol="json",this.binaryType="blob"}return i(e,[{key:"encode",value:function(e){return JSON.stringify(e)}},{key:"decode",value:function(e){return JSON.parse(e)}}]),e}()},{}],5:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getWebSocket=function(e,t,s){var i=n.isNode?(o=e,/^ws(s)?:\/\//.test(o)?o:null):function(e){var t=void 0,s=void 0;if(/^ws(s)?:\/\//.test(e))return e;return t="https:"===window.location.protocol?"wss://":"ws://",e?"/"===e[0]?(s=""!==window.location.port?":"+window.location.port:"",t+window.location.hostname+s+e):t+e:(s=""!==window.location.port?":"+window.location.port:"",t+window.location.hostname+s+"/ws")}(e);var o;if(!i)return null;{if(s)return new s(i,t);if(n.isNode)return null;if("WebSocket"in window)return new window.WebSocket(i,t);if("MozWebSocket"in window)return new window.MozWebSocket(i,t)}return null},s.isBinaryTypeAllowed=function(e){return-1!==n.ALLOWED_BINARY_TYPES.indexOf(e)};var n=e("./constants")},{"./constants":3}],6:[function(s,e,r){(function(i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Wampy=void 0;var e=function(){function i(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,s){return t&&i(e.prototype,t),s&&i(e,s),e}}(),a=s("./constants"),o=s("./utils"),n=s("./serializers/JsonSerializer");var t=function(){function s(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.version="v5.0.2",this._url="string"==typeof e?e:null,this._protocols=["wamp.2.json"],this._wamp_features={agent:"Wampy.js "+this.version,roles:{publisher:{features:{subscriber_blackwhite_listing:!0,publisher_exclusion:!0,publisher_identification:!0}},subscriber:{},caller:{features:{caller_identification:!0,progressive_call_results:!0,call_canceling:!0,call_timeout:!0}},callee:{features:{caller_identification:!0}}}},this._cache={sessionId:null,reqId:0,server_wamp_features:{roles:{}},isSayingGoodbye:!1,opStatus:{code:0,description:"Success!",reqId:0},timer:null,reconnectingAttempts:0},this._ws=null,this._wsQueue=[],this._requests={},this._calls={},this._subscriptions={},this._subsTopics=new Set,this._rpcRegs={},this._rpcNames=new Set,this._options={debug:!1,autoReconnect:!0,reconnectInterval:2e3,maxRetries:25,realm:null,helloCustomDetails:null,authid:null,authmethods:[],onChallenge:null,onConnect:null,onClose:null,onError:null,onReconnect:null,onReconnectSuccess:null,ws:null,serializer:new n.JsonSerializer},this._isPlainObject(t)?this._options=this._merge(this._options,t):this._isPlainObject(e)&&(this._options=this._merge(this._options,e)),this.connect()}return e(s,[{key:"_log",value:function(){this._options.debug}},{key:"_getReqId",value:function(){return++this._cache.reqId}},{key:"_merge",value:function(){var e={},t=arguments.length,s=void 0,i=void 0;for(s=0;s<t;s++)for(i in arguments[s])e[i]=arguments[s][i];return e}},{key:"_isArray",value:function(e){return!!e&&Array.isArray(e)}},{key:"_isPlainObject",value:function(e){return!!e&&e.constructor===Object}},{key:"_setWsProtocols",value:function(){this._options.serializer instanceof n.JsonSerializer||this._protocols.unshift("wamp.2."+this._options.serializer.protocol)}},{key:"_preReqChecks",value:function(e,t,s){var i=!0;return this._cache.sessionId&&!this._cache.server_wamp_features.roles[t]&&(this._cache.opStatus=a.WAMP_ERROR_MSG["NO_"+t.toUpperCase()],i=!1),e&&!this._validateURI(e)&&(this._cache.opStatus=a.WAMP_ERROR_MSG.URI_ERROR,i=!1),!!i||(this._isPlainObject(s)&&s.onError&&s.onError(this._cache.opStatus.description),!1)}},{key:"_validateURI",value:function(e){return!(!/^([0-9a-zA-Z_]{2,}\.)*([0-9a-zA-Z_]{2,})$/.test(e)||0===e.indexOf("wamp"))}},{key:"_encode",value:function(e){try{return this._options.serializer.encode(e)}catch(e){throw new Error("[wampy] encoding exception!")}}},{key:"_decode",value:function(e){try{return this._options.serializer.decode(e)}catch(e){throw new Error("[wampy] decoding exception!")}}},{key:"_send",value:function(e){if(e&&this._wsQueue.push(this._encode(e)),this._ws&&1===this._ws.readyState&&this._cache.sessionId)for(;this._wsQueue.length;)this._ws.send(this._wsQueue.shift())}},{key:"_resetState",value:function(){this._wsQueue=[],this._subscriptions={},this._subsTopics=new Set,this._requests={},this._calls={},this._rpcRegs={},this._rpcNames=new Set,this._cache={reqId:0,reconnectingAttempts:0}}},{key:"_initWsCallbacks",value:function(){var t=this;this._ws&&(this._ws.onopen=function(){t._wsOnOpen()},this._ws.onclose=function(e){t._wsOnClose(e)},this._ws.onmessage=function(e){t._wsOnMessage(e)},this._ws.onerror=function(e){t._wsOnError(e)})}},{key:"_wsOnOpen",value:function(){var e=this._merge(this._options.helloCustomDetails,this._wamp_features);this._options.authid&&(e.authmethods=this._options._authmethods,e.authid=this._options.authid),this._log("[wampy] websocket connected"),this._ws.protocol&&this._options.serializer.protocol!==this._ws.protocol.split(".")[2]&&(this._options.serializer=new n.JsonSerializer);var t=this._options.serializer.binaryType;if(!(0,o.isBinaryTypeAllowed)(t))throw new Error("Binary type is not allowed: "+t);this._ws.binaryType=t,this._ws.send(this._encode([a.WAMP_MSG_SPEC.HELLO,this._options.realm,e]))}},{key:"_wsOnClose",value:function(e){var t=this,s=a.isNode?i:window;this._log("[wampy] websocket disconnected. Info: ",e),(this._cache.sessionId||this._cache.reconnectingAttempts)&&this._options.autoReconnect&&this._cache.reconnectingAttempts<this._options.maxRetries&&!this._cache.isSayingGoodbye?(this._cache.sessionId=null,this._cache.timer=s.setTimeout(function(){t._wsReconnect()},this._options.reconnectInterval)):(this._options.onClose&&this._options.onClose(),this._resetState(),this._ws=null)}},{key:"_wsOnMessage",value:function(e){var s,i=this,t=void 0,o=void 0,n=void 0;switch(this._log("[wampy] websocket message received",e.data),(s=this._decode(e.data))[0]){case a.WAMP_MSG_SPEC.WELCOME:this._cache.sessionId=s[1],this._cache.server_wamp_features=s[2],this._cache.reconnectingAttempts?(this._cache.reconnectingAttempts=0,this._options.onReconnectSuccess&&this._options.onReconnectSuccess(),this._renewSubscriptions(),this._renewRegistrations()):this._options.onConnect&&this._options.onConnect(),this._send();break;case a.WAMP_MSG_SPEC.ABORT:this._options.onError&&this._options.onError(s[1].message?s[1].message:s[2]),this._ws.close();break;case a.WAMP_MSG_SPEC.CHALLENGE:this._options.authid&&"function"==typeof this._options.onChallenge?new Promise(function(e,t){e(i._options.onChallenge(s[1],s[2]))}).then(function(e){i._ws.send(i._encode([a.WAMP_MSG_SPEC.AUTHENTICATE,e,{}]))}).catch(function(e){i._ws.send(i._encode([a.WAMP_MSG_SPEC.ABORT,{message:"Exception in onChallenge handler raised!"},"wamp.error.cannot_authenticate"])),i._options.onError&&i._options.onError(a.WAMP_ERROR_MSG.CRA_EXCEPTION.description),i._ws.close(),i._cache.opStatus=a.WAMP_ERROR_MSG.CRA_EXCEPTION}):(this._ws.send(this._encode([a.WAMP_MSG_SPEC.ABORT,{message:a.WAMP_ERROR_MSG.NO_CRA_CB_OR_ID.description},"wamp.error.cannot_authenticate"])),this._options.onError&&this._options.onError(a.WAMP_ERROR_MSG.NO_CRA_CB_OR_ID.description),this._ws.close(),this._cache.opStatus=a.WAMP_ERROR_MSG.NO_CRA_CB_OR_ID);break;case a.WAMP_MSG_SPEC.GOODBYE:this._cache.isSayingGoodbye||(this._cache.isSayingGoodbye=!0,this._send([a.WAMP_MSG_SPEC.GOODBYE,{},"wamp.error.goodbye_and_out"])),this._cache.sessionId=null,this._ws.close();break;case a.WAMP_MSG_SPEC.ERROR:switch(s[1]){case a.WAMP_MSG_SPEC.SUBSCRIBE:case a.WAMP_MSG_SPEC.UNSUBSCRIBE:case a.WAMP_MSG_SPEC.PUBLISH:case a.WAMP_MSG_SPEC.REGISTER:case a.WAMP_MSG_SPEC.UNREGISTER:this._requests[s[2]]&&this._requests[s[2]].callbacks.onError&&this._requests[s[2]].callbacks.onError(s[4],s[3],s[5],s[6]),delete this._requests[s[2]];break;case a.WAMP_MSG_SPEC.INVOCATION:break;case a.WAMP_MSG_SPEC.CALL:this._calls[s[2]]&&this._calls[s[2]].onError&&this._calls[s[2]].onError(s[4],s[3],s[5],s[6]),delete this._calls[s[2]];break;default:this._log("[wampy] Received non-compliant WAMP ERROR message")}break;case a.WAMP_MSG_SPEC.SUBSCRIBED:this._requests[s[1]]&&(this._subscriptions[this._requests[s[1]].topic]=this._subscriptions[s[2]]={id:s[2],callbacks:[this._requests[s[1]].callbacks.onEvent]},this._subsTopics.add(this._requests[s[1]].topic),this._requests[s[1]].callbacks.onSuccess&&this._requests[s[1]].callbacks.onSuccess(),delete this._requests[s[1]]);break;case a.WAMP_MSG_SPEC.UNSUBSCRIBED:this._requests[s[1]]&&(t=this._subscriptions[this._requests[s[1]].topic].id,delete this._subscriptions[this._requests[s[1]].topic],delete this._subscriptions[t],this._subsTopics.has(this._requests[s[1]].topic)&&this._subsTopics.delete(this._requests[s[1]].topic),this._requests[s[1]].callbacks.onSuccess&&this._requests[s[1]].callbacks.onSuccess(),delete this._requests[s[1]]);break;case a.WAMP_MSG_SPEC.PUBLISHED:this._requests[s[1]]&&(this._requests[s[1]].callbacks&&this._requests[s[1]].callbacks.onSuccess&&this._requests[s[1]].callbacks.onSuccess(),delete this._requests[s[1]]);break;case a.WAMP_MSG_SPEC.EVENT:if(this._subscriptions[s[1]])for(o=this._subscriptions[s[1]].callbacks.length;o--;)this._subscriptions[s[1]].callbacks[o](s[4],s[5]);break;case a.WAMP_MSG_SPEC.RESULT:this._calls[s[1]]&&(this._calls[s[1]].onSuccess(s[3],s[4]),s[2].progress&&!0===s[2].progress||delete this._calls[s[1]]);break;case a.WAMP_MSG_SPEC.REGISTERED:this._requests[s[1]]&&(this._rpcRegs[this._requests[s[1]].topic]=this._rpcRegs[s[2]]={id:s[2],callbacks:[this._requests[s[1]].callbacks.rpc]},this._rpcNames.add(this._requests[s[1]].topic),this._requests[s[1]].callbacks&&this._requests[s[1]].callbacks.onSuccess&&this._requests[s[1]].callbacks.onSuccess(),delete this._requests[s[1]]);break;case a.WAMP_MSG_SPEC.UNREGISTERED:this._requests[s[1]]&&(t=this._rpcRegs[this._requests[s[1]].topic].id,delete this._rpcRegs[this._requests[s[1]].topic],delete this._rpcRegs[t],this._rpcNames.has(this._requests[s[1]].topic)&&this._rpcNames.delete(this._requests[s[1]].topic),this._requests[s[1]].callbacks&&this._requests[s[1]].callbacks.onSuccess&&this._requests[s[1]].callbacks.onSuccess(),delete this._requests[s[1]]);break;case a.WAMP_MSG_SPEC.INVOCATION:this._rpcRegs[s[2]]?new Promise(function(e,t){e(i._rpcRegs[s[2]].callbacks[0](s[4],s[5],s[3]))}).then(function(e){n=[a.WAMP_MSG_SPEC.YIELD,s[1],{}],i._isArray(e)?(i._isPlainObject(e[0])&&(n[2]=e[0]),i._isArray(e[1])?n.push(e[1]):void 0!==e[1]&&n.push([e[1]]),i._isPlainObject(e[2])&&(3===n.length&&n.push([]),n.push(e[2]))):n=[a.WAMP_MSG_SPEC.YIELD,s[1],{}],i._send(n)}).catch(function(e){var t=[a.WAMP_MSG_SPEC.ERROR,a.WAMP_MSG_SPEC.INVOCATION,s[1],e.details||{},e.uri||"wamp.error.invocation_exception"];e.argsList&&i._isArray(e.argsList)&&t.push(e.argsList),e.argsDict&&i._isPlainObject(e.argsDict)&&(5===t.length&&t.push([]),t.push(e.argsDict)),i._send(t)}):(this._send([a.WAMP_MSG_SPEC.ERROR,a.WAMP_MSG_SPEC.INVOCATION,s[1],{},"wamp.error.no_such_procedure"]),this._cache.opStatus=a.WAMP_ERROR_MSG.NON_EXIST_RPC_INVOCATION);break;default:this._log("[wampy] Received non-compliant WAMP message")}}},{key:"_wsOnError",value:function(e){this._log("[wampy] websocket error"),this._options.onError&&this._options.onError(e)}},{key:"_wsReconnect",value:function(){this._log("[wampy] websocket reconnecting..."),this._options.onReconnect&&this._options.onReconnect(),this._cache.reconnectingAttempts++,this._ws=(0,o.getWebSocket)(this._url,this._protocols,this._options.ws),this._initWsCallbacks()}},{key:"_renewSubscriptions",value:function(){var e=void 0,t=this._subscriptions,s=this._subsTopics;this._subscriptions={},this._subsTopics=new Set;var i=!0,o=!1,n=void 0;try{for(var r,c=s[Symbol.iterator]();!(i=(r=c.next()).done);i=!0){var a=r.value;for(e=t[a].callbacks.length;e--;)this.subscribe(a,t[a].callbacks[e])}}catch(e){o=!0,n=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw n}}}},{key:"_renewRegistrations",value:function(){var e=this._rpcRegs,t=this._rpcNames;this._rpcRegs={},this._rpcNames=new Set;var s=!0,i=!1,o=void 0;try{for(var n,r=t[Symbol.iterator]();!(s=(n=r.next()).done);s=!0){var c=n.value;this.register(c,{rpc:e[c].callbacks[0]})}}catch(e){i=!0,o=e}finally{try{!s&&r.return&&r.return()}finally{if(i)throw o}}}},{key:"options",value:function(e){return void 0===e?this._options:this._isPlainObject(e)?(this._options=this._merge(this._options,e),this):void 0}},{key:"getOpStatus",value:function(){return this._cache.opStatus}},{key:"getSessionId",value:function(){return this._cache.sessionId}},{key:"connect",value:function(e){if(e&&(this._url=e),this._options.realm){var t=(this._options.authid?1:0)+(this._isArray(this._options.authmethods)&&this._options.authmethods.length?1:0)+("function"==typeof this._options.onChallenge?1:0);if(0<t&&t<3)return this._cache.opStatus=a.WAMP_ERROR_MSG.NO_CRA_CB_OR_ID,this;if(this._setWsProtocols(),this._ws=(0,o.getWebSocket)(this._url,this._protocols,this._options.ws),!this._ws)return this._cache.opStatus=a.WAMP_ERROR_MSG.NO_WS_OR_URL,this;this._initWsCallbacks()}else this._cache.opStatus=a.WAMP_ERROR_MSG.NO_REALM;return this}},{key:"disconnect",value:function(){return this._cache.sessionId?(this._cache.isSayingGoodbye=!0,this._send([a.WAMP_MSG_SPEC.GOODBYE,{},"wamp.error.system_shutdown"])):this._ws&&this._ws.close(),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this}},{key:"abort",value:function(){return this._cache.sessionId||1!==this._ws.readyState||(this._send([a.WAMP_MSG_SPEC.ABORT,{},"wamp.error.abort"]),this._cache.sessionId=null),this._ws.close(),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this}},{key:"subscribe",value:function(e,t){var s=void 0;if(!this._preReqChecks(e,"broker",t))return this;if("function"==typeof t)t={onEvent:t};else if(!this._isPlainObject(t)||void 0===t.onEvent)return this._cache.opStatus=a.WAMP_ERROR_MSG.NO_CALLBACK_SPEC,this._isPlainObject(t)&&t.onError&&t.onError(this._cache.opStatus.description),this;return this._subscriptions[e]&&this._subscriptions[e].callbacks.length?(this._subscriptions[e].callbacks.indexOf(t.onEvent)<0&&this._subscriptions[e].callbacks.push(t.onEvent),t.onSuccess&&t.onSuccess()):(s=this._getReqId(),this._requests[s]={topic:e,callbacks:t},this._send([a.WAMP_MSG_SPEC.SUBSCRIBE,s,{},e])),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this._cache.opStatus.reqId=s,this}},{key:"unsubscribe",value:function(e,t){var s=void 0,i=-1;return this._preReqChecks(null,"broker",t)?this._subscriptions[e]?(s=this._getReqId(),void 0===t?(this._subscriptions[e].callbacks=[],t={}):"function"==typeof t?(i=this._subscriptions[e].callbacks.indexOf(t),t={}):t.onEvent&&"function"==typeof t.onEvent?i=this._subscriptions[e].callbacks.indexOf(t.onEvent):this._subscriptions[e].callbacks=[],0<=i&&this._subscriptions[e].callbacks.splice(i,1),this._subscriptions[e].callbacks.length?this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS:(this._requests[s]={topic:e,callbacks:t},this._send([a.WAMP_MSG_SPEC.UNSUBSCRIBE,s,this._subscriptions[e].id]),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this._cache.opStatus.reqId=s),this):(this._cache.opStatus=a.WAMP_ERROR_MSG.NON_EXIST_UNSUBSCRIBE,this._isPlainObject(t)&&t.onError&&t.onError(this._cache.opStatus.description),this):this}},{key:"publish",value:function(e,t,s,i){var o,n=void 0,r=!1,c={};if(!this._preReqChecks(e,"broker",s))return this;if(this._isPlainObject(s)&&(c.acknowledge=!0),void 0!==i&&(this._isPlainObject(i)?(i.exclude&&(this._isArray(i.exclude)&&i.exclude.length?c.exclude=i.exclude:"number"==typeof i.exclude?c.exclude=[i.exclude]:r=!0),i.exclude_authid&&(this._isArray(i.exclude_authid)&&i.exclude_authid.length?c.exclude_authid=i.exclude_authid:"string"==typeof i.exclude_authid?c.exclude_authid=[i.exclude_authid]:r=!0),i.exclude_authrole&&(this._isArray(i.exclude_authrole)&&i.exclude_authrole.length?c.exclude_authrole=i.exclude_authrole:"string"==typeof i.exclude_authrole?c.exclude_authrole=[i.exclude_authrole]:r=!0),i.eligible&&(this._isArray(i.eligible)&&i.eligible.length?c.eligible=i.eligible:"number"==typeof i.eligible?c.eligible=[i.eligible]:r=!0),i.eligible_authid&&(this._isArray(i.eligible_authid)&&i.eligible_authid.length?c.eligible_authid=i.eligible_authid:"string"==typeof i.eligible_authid?c.eligible_authid=[i.eligible_authid]:r=!0),i.eligible_authrole&&(this._isArray(i.eligible_authrole)&&i.eligible_authrole.length?c.eligible_authrole=i.eligible_authrole:"string"==typeof i.eligible_authrole?c.eligible_authrole=[i.eligible_authrole]:r=!0),i.hasOwnProperty("exclude_me")&&(c.exclude_me=!1!==i.exclude_me),i.hasOwnProperty("disclose_me")&&(c.disclose_me=!0===i.disclose_me)):r=!0,r))return this._cache.opStatus=a.WAMP_ERROR_MSG.INVALID_PARAM,this._isPlainObject(s)&&s.onError&&s.onError(this._cache.opStatus.description),this;switch(o=this._getReqId(),arguments.length){case 1:n=[a.WAMP_MSG_SPEC.PUBLISH,o,c,e];break;case 2:n=this._isArray(t)?[a.WAMP_MSG_SPEC.PUBLISH,o,c,e,t]:this._isPlainObject(t)?[a.WAMP_MSG_SPEC.PUBLISH,o,c,e,[],t]:[a.WAMP_MSG_SPEC.PUBLISH,o,c,e,[t]];break;default:this._requests[o]={topic:e,callbacks:s},n=this._isArray(t)?[a.WAMP_MSG_SPEC.PUBLISH,o,c,e,t]:this._isPlainObject(t)?[a.WAMP_MSG_SPEC.PUBLISH,o,c,e,[],t]:[a.WAMP_MSG_SPEC.PUBLISH,o,c,e,[t]]}return this._send(n),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this._cache.opStatus.reqId=o,this}},{key:"call",value:function(e,t,s,i){var o=void 0,n=void 0,r=!1,c={};if(!this._preReqChecks(e,"dealer",s))return this;if("function"==typeof s)s={onSuccess:s};else if(!this._isPlainObject(s)||void 0===s.onSuccess)return this._cache.opStatus=a.WAMP_ERROR_MSG.NO_CALLBACK_SPEC,this._isPlainObject(s)&&s.onError&&s.onError(this._cache.opStatus.description),this;if(void 0!==i&&(this._isPlainObject(i)?(i.hasOwnProperty("disclose_me")&&(c.disclose_me=!0===i.disclose_me),i.hasOwnProperty("receive_progress")&&(c.receive_progress=!0===i.receive_progress),i.hasOwnProperty("timeout")&&("number"==typeof i.timeout?c.timeout=i.timeout:r=!0)):r=!0,r))return this._cache.opStatus=a.WAMP_ERROR_MSG.INVALID_PARAM,this._isPlainObject(s)&&s.onError&&s.onError(this._cache.opStatus.description),this;for(;(o=this._getReqId())in this._calls;);return this._calls[o]=s,n=null===t?[a.WAMP_MSG_SPEC.CALL,o,c,e]:this._isArray(t)?[a.WAMP_MSG_SPEC.CALL,o,c,e,t]:this._isPlainObject(t)?[a.WAMP_MSG_SPEC.CALL,o,c,e,[],t]:[a.WAMP_MSG_SPEC.CALL,o,c,e,[t]],this._send(n),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this._cache.opStatus.reqId=o,this}},{key:"cancel",value:function(e,t,s){var i={mode:"skip"};return this._preReqChecks(null,"dealer",t)&&(e&&this._calls[e]?(void 0!==s&&this._isPlainObject(s)&&s.hasOwnProperty("mode")&&(i.mode=/skip|kill|killnowait/.test(s.mode)?s.mode:"skip"),this._send([a.WAMP_MSG_SPEC.CANCEL,e,i]),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this._cache.opStatus.reqId=e,t.onSuccess&&t.onSuccess()):(this._cache.opStatus=a.WAMP_ERROR_MSG.NON_EXIST_RPC_REQ_ID,this._isPlainObject(t)&&t.onError&&t.onError(this._cache.opStatus.description))),this}},{key:"register",value:function(e,t){var s=void 0;if(!this._preReqChecks(e,"dealer",t))return this;if("function"==typeof t)t={rpc:t};else if(!this._isPlainObject(t)||void 0===t.rpc)return this._cache.opStatus=a.WAMP_ERROR_MSG.NO_CALLBACK_SPEC,this._isPlainObject(t)&&t.onError&&t.onError(this._cache.opStatus.description),this;return this._rpcRegs[e]&&this._rpcRegs[e].callbacks.length?(this._cache.opStatus=a.WAMP_ERROR_MSG.RPC_ALREADY_REGISTERED,this._isPlainObject(t)&&t.onError&&t.onError(this._cache.opStatus.description)):(s=this._getReqId(),this._requests[s]={topic:e,callbacks:t},this._send([a.WAMP_MSG_SPEC.REGISTER,s,{},e]),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this._cache.opStatus.reqId=s),this}},{key:"unregister",value:function(e,t){var s=void 0;return this._preReqChecks(e,"dealer",t)&&("function"==typeof t&&(t={onSuccess:t}),this._rpcRegs[e]?(s=this._getReqId(),this._requests[s]={topic:e,callbacks:t},this._send([a.WAMP_MSG_SPEC.UNREGISTER,s,this._rpcRegs[e].id]),this._cache.opStatus=a.WAMP_ERROR_MSG.SUCCESS,this._cache.opStatus.reqId=s):(this._cache.opStatus=a.WAMP_ERROR_MSG.NON_EXIST_RPC_UNREG,this._isPlainObject(t)&&t.onError&&t.onError(this._cache.opStatus.description))),this}}]),s}();r.default=t,r.Wampy=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./constants":3,"./serializers/JsonSerializer":4,"./utils":5}]},{},[2]);
//# sourceMappingURL=wampy.min.js.map